<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="HTB Machine Write Up -ServMon"><title>Hack The Box Write Up - ServMon | zRyuki</title><meta name="generator" content="Jekyll v4.0.0" /><meta property="og:title" content="Hack The Box Write Up - ServMon" /><meta name="author" content="zRyuki" /><meta property="og:locale" content="en_US" /><meta name="description" content="HTB Machine Write Up -ServMon" /><meta property="og:description" content="HTB Machine Write Up -ServMon" /><link rel="canonical" href="https://zeroryuki.github.io/posts/servmon/" /><meta property="og:url" content="https://zeroryuki.github.io/posts/servmon/" /><meta property="og:site_name" content="zRyuki" /><meta property="og:image" content="https://zeroryuki.github.io/img/ServMon/badge.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-04-19T22:26:59+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zeroryuki.github.io/img/ServMon/badge.png" /><meta property="twitter:title" content="Hack The Box Write Up - ServMon" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@zRyuki" /><meta name="google-site-verification" content="uR4O3tdC8ptzD19y4h81kQmgw4DIjwMC-FIW5gIrfkM" /> <script type="application/ld+json"> {"headline":"Hack The Box Write Up - ServMon","dateModified":"2020-04-19T22:26:59+08:00","datePublished":"2020-04-19T22:26:59+08:00","author":{"@type":"Person","name":"zRyuki"},"description":"HTB Machine Write Up -ServMon","mainEntityOfPage":{"@type":"WebPage","@id":"https://zeroryuki.github.io/posts/servmon/"},"image":"https://zeroryuki.github.io/img/ServMon/badge.png","@type":"BlogPosting","url":"https://zeroryuki.github.io/posts/servmon/","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/zeroryuki/ © 2019 zRyuki Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/icons.css"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/custom.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script> window.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>'); </script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script> <script src="/assets/js/dist/commons.js" async></script><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script> <script src="/assets/js/dist/tooltip-loader.min.js" async></script><meta content="zRyuki" property="og:site_name"><meta content="Hack The Box Write Up - ServMon" property="og:title"><meta content="article" property="og:type"><meta content="HTB Machine Write Up -ServMon" property="og:description"><meta content="https://zeroryuki.github.io/posts/servmon/" property="og:url"><meta content="2020-04-19T22:26:59+08:00" property="article:published_time"><meta content="https://zeroryuki.github.io/about/" property="article:author"><meta content="https://zeroryuki.github.io/img/ServMon/badge.png" property="og:image"><meta content="machine" property="article:section"><meta content="htb" property="article:tag"><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="https://avatars2.githubusercontent.com/u/34531838" alt="avatar"> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/">zRyuki</a></div><div id="site-subtitle" class="font-italic">Systems were built to be owned</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/zeroryuki" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="javascript:window.open('mailto:' + ['zeroryuki','gmail.com'].join('@'))"> <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" target="_blank"> <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hack The Box Write Up - ServMon</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hack The Box Write Up - ServMon</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Sun, Apr 19, 2020, 10:26 PM +0800"> Apr 19, 2020 <i class="unloaded">2020-04-19T22:26:59+08:00</i> </span> by <span class="author"> zRyuki </span></div></div><div class="row"><div class="col-lg-6"> <img src="/img/ServMon/icon.png"></div><div class="col-lg-5"><h2 data-toc-skip class="text-center">ServMon</h2><p></p><table class="table table-hover table-striped"><tbody><tr><td class="text-right">OS:<td> <img src="/img/Windows.png" height="15"> Windows<tr><td class="text-right">Difficulty:<td> <span class="text-warning bold"> Medium</span><tr><td class="text-right">Points:<td><span class="text-success">20</span><tr><td class="text-right">Release:<td>11 Apr 2020<tr><td class="text-right">IP:<td>10.10.10.184</table></div></div><div class="post-content"><h2 id="info-gathering">Info Gathering</h2><h3 id="nmap">Nmap</h3><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>Nmap 7.80SVN scan initiated Wed Apr 15 01:59:46 2020 as: nmap <span class="nt">-vv</span> <span class="nt">--reason</span> <span class="nt">-Pn</span> <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">--version-all</span> <span class="nt">-oN</span> /home/z3r0/CTF/HTB/Machine/Servmon/scans/_quick_tcp_nmap.txt <span class="nt">-oX</span> /home/z3r0/CTF/HTB/Machine/Servmon/scans/xml/_quick_tcp_nmap.xml 10.10.10.184
<span class="go">Nmap scan report for 10.10.10.184
Host is up, received user-set (0.13s latency).
Scanned at 2020-04-15 01:59:47 +08 for 621s
Not shown: 991 closed ports
Reason: 991 conn-refused
PORT     STATE SERVICE       REASON  VERSION
21/tcp   open  ftp           syn-ack Microsoft ftpd
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
</span><span class="gp">|_01-18-20  12:05PM       &lt;DIR&gt;</span><span class="w">          </span>Users
<span class="go">| ftp-syst: 
|_  SYST: Windows_NT
22/tcp   open  ssh           syn-ack OpenSSH for_Windows_7.7 (protocol 2.0)
| ssh-hostkey: 
|   2048 b9:89:04:ae:b6:26:07:3f:61:89:75:cf:10:29:28:83 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDnC92+BCplDo38VDQIZzb7V3HN/OucvxF0VMDDoYShdUrpDUW6JcSR/Zr6cADbHy7eDLw2O+WW+M4SzH7kfpbTv3HvJ0z8iOsRs2nUrUint4CR/A2vYA9SFOk18FU0QUS0sByBIlemU0uiPxN+iRCcpFhZDj+eiVRF7o/XxNbExnhU/2n9MXwFS8XTYNeGqSLE1vV6KdpMfpJj/yey8gvEpDQTX5OQK+kkUHze3LXLyu/XVTKzfqUBMAP+IQ5F6ICWgaC1a+cx/D7C/aobCbqaXY+75t1mxbEMmm1Wv/42nVQxcT7tN2C3sds4VJkYgZKcBhsE0XdJcR9mTb1wWsg9
|   256 71:4e:6c:c0:d3:6e:57:4f:06:b8:95:3d:c7:75:57:53 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMToH2eB7rzpMZuvElpHYko/TXSsOfG8EXWQxmC/T4PCaAmVRDgJWEFMHgpRilSAKoOBlS2RHWNpMJldTFbWSVo=
|   256 15:38:bd:75:06:71:67:7a:01:17:9c:5c:ed:4c:de:0e (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILbqSRVLRJFVNhD0W0C5xB7b3RoJZZKdM+jSGryFWOQa
80/tcp   open  http          syn-ack
| fingerprint-strings: 
|   GetRequest, HTTPOptions, RTSPRequest: 
|     HTTP/1.1 200 OK
|     Content-type: text/html
|     Content-Length: 340
|     Connection: close
|     AuthInfo: 
</span><span class="gp">|     &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</span><span class="w">
</span><span class="gp">|     &lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;</span><span class="w">
</span><span class="gp">|     &lt;head&gt;</span><span class="w">
</span><span class="gp">|     &lt;title&gt;</span>&lt;/title&gt;
<span class="gp">|     &lt;script type="text/javascript"&gt;</span><span class="w">
</span><span class="gp">|     window.location.href = "Pages/login.htm";</span><span class="w">
</span><span class="gp">|     &lt;/script&gt;</span><span class="w">
</span><span class="gp">|     &lt;/head&gt;</span><span class="w">
</span><span class="gp">|     &lt;body&gt;</span><span class="w">
</span><span class="gp">|     &lt;/body&gt;</span><span class="w">
</span><span class="gp">|     &lt;/html&gt;</span><span class="w">
</span><span class="go">|   NULL: 
|     HTTP/1.1 408 Request Timeout
|     Content-type: text/html
|     Content-Length: 0
|     Connection: close
|_    AuthInfo:
|_http-favicon: Unknown favicon MD5: 3AEF8B29C4866F96A539730FAB53A88F
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Site doesn't have a title (text/html).
|_http-trane-info: Problem with XML parsing of /evox/about
135/tcp  open  msrpc?        syn-ack
139/tcp  open  netbios-ssn   syn-ack Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds? syn-ack
5666/tcp open  nrpe?         syn-ack
6699/tcp open  napster?      syn-ack
8443/tcp open  tcpwrapped    syn-ack
| http-methods: 
|_  Supported Methods: GET
| ssl-cert: Subject: commonName=localhost
| Issuer: commonName=localhost
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2020-01-14T13:24:20
| Not valid after:  2021-01-13T13:24:20
| MD5:   1d03 0c40 5b7a 0f6d d8c8 78e3 cba7 38b4
| SHA-1: 7083 bd82 b4b0 f9c0 cc9c 5019 2f9f 9291 4694 8334
| -----BEGIN CERTIFICATE-----
| MIICoTCCAYmgAwIBAgIBADANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAlsb2Nh
| bGhvc3QwHhcNMjAwMTE0MTMyNDIwWhcNMjEwMTEzMTMyNDIwWjAUMRIwEAYDVQQD
| DAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDXCoMi
| kUUWbCi0E1C/LfZFrm4UKCheesOFUAITOnrCvfkYmUR0o7v9wQ8yR5sQR8OIxfJN
| vOTE3C/YZjPE/XLFrLhBpb64X83rqzFRwX7bHVr+PZmHQR0qFRvrsWoQTKcjrElo
| R4WgF4AWkR8vQqsCADPuDGIsNb6PyXSru8/A/HJSt5ef8a3dcOCszlm2bP62qsa8
| XqumPHAKKwiu8k8N94qyXyVwOxbh1nPcATwede5z/KkpKBtpNfSFjrL+sLceQC5S
| wU8u06kPwgzrqTM4L8hyLbsgGcByOBeWLjPJOuR0L/a33yTL3lLFDx/RwGIln5s7
| BwX8AJUEl+6lRs1JAgMBAAEwDQYJKoZIhvcNAQEFBQADggEBAAjXGVBKBNUUVJ51
| b2f08SxINbWy4iDxomygRhT/auRNIypAT2muZ2//KBtUiUxaHZguCwUUzB/1jiED
| s/IDA6dWvImHWnOZGgIUsLo/242RsNgKUYYz8sxGeDKceh6F9RvyG3Sr0OyUrPHt
| sc2hPkgZ0jgf4igc6/3KLCffK5o85bLOQ4hCmJqI74aNenTMNnojk42NfBln2cvU
| vK13uXz0wU1PDgfyGrq8DL8A89zsmdW6QzBElnNKpqNdSj+5trHe7nYYM5m0rrAb
| H2nO4PdFbPGJpwRlH0BOm0kIY0az67VfOakdo1HiWXq5ZbhkRm27B2zO7/ZKfVIz
| XXrt6LA=
|_-----END CERTIFICATE-----
|_ssl-date: TLS randomness does not represent time
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port80-TCP:V=7.80SVN%I=9%D=4/15%Time=5E95FA3E%P=x86_64-unknown-linux-gn
SF:u%r(NULL,6B,"HTTP/1\.1\x20408\x20Request\x20Timeout\r\nContent-type:\x2
SF:0text/html\r\nContent-Length:\x200\r\nConnection:\x20close\r\nAuthInfo:
SF:\x20\r\n\r\n")%r(GetRequest,1B4,"HTTP/1\.1\x20200\x20OK\r\nContent-type
SF::\x20text/html\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAut
SF:hInfo:\x20\r\n\r\n\xef\xbb\xbf&lt;!DOCTYPE\x20html\x20PUBLIC\x20\"-//W3C//
SF:DTD\x20XHTML\x201\.0\x20Transitional//EN\"\x20\"http://www\.w3\.org/TR/
</span><span class="gp">SF:xhtml1/DTD/xhtml1-transitional\.dtd\"&gt;</span><span class="se">\r\n\r\n</span>&lt;html<span class="se">\x</span><span class="nv">20xmlns</span><span class="o">=</span><span class="se">\"</span>http://w
<span class="gp">SF:ww\.w3\.org/1999/xhtml\"&gt;</span><span class="se">\r\n</span>&lt;<span class="nb">head</span><span class="o">&gt;</span><span class="se">\r\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20&lt;title&gt;&lt;/title&gt;<span class="se">\</span>
SF:r<span class="se">\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20&lt;script<span class="se">\x</span><span class="nv">20type</span><span class="o">=</span><span class="se">\"</span>text/javascript<span class="se">\"</span><span class="o">&gt;</span><span class="se">\r\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20
<span class="go">SF:\x20\x20\x20\x20\x20window\.location\.href\x20=\x20\"Pages/login\.htm\"
</span><span class="gp">SF:;</span><span class="se">\r\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20&lt;/script&gt;<span class="se">\r\n</span>&lt;/head&gt;<span class="se">\r\n</span>&lt;body&gt;<span class="se">\r\n</span>&lt;/body&gt;<span class="se">\r\n</span>&lt;/htm
<span class="gp">SF:l&gt;</span><span class="se">\r\n</span><span class="s2">")%r(HTTPOptions,1B4,"</span>HTTP/1<span class="se">\.</span>1<span class="se">\x</span>20200<span class="se">\x</span>20OK<span class="se">\r\n</span>Content-type:<span class="se">\x</span>20
<span class="go">SF:text/html\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo
SF::\x20\r\n\r\n\xef\xbb\xbf&lt;!DOCTYPE\x20html\x20PUBLIC\x20\"-//W3C//DTD\x
SF:20XHTML\x201\.0\x20Transitional//EN\"\x20\"http://www\.w3\.org/TR/xhtml
</span><span class="gp">SF:1/DTD/xhtml1-transitional\.dtd\"&gt;</span><span class="se">\r\n\r\n</span>&lt;html<span class="se">\x</span><span class="nv">20xmlns</span><span class="o">=</span><span class="se">\"</span>http://www<span class="se">\.</span>w
<span class="gp">SF:3\.org/1999/xhtml\"&gt;</span><span class="se">\r\n</span>&lt;<span class="nb">head</span><span class="o">&gt;</span><span class="se">\r\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20&lt;title&gt;&lt;/title&gt;<span class="se">\r\n\x</span>
<span class="gp">SF:20\x20\x20\x20&lt;script\x20type=\"text/javascript\"&gt;</span><span class="se">\r\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\</span>
SF:x20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20window<span class="se">\.</span>location<span class="se">\.</span>href<span class="se">\x</span><span class="nv">20</span><span class="o">=</span><span class="se">\x</span>20<span class="se">\"</span>Pages/login<span class="se">\.</span>htm<span class="se">\"</span><span class="p">;</span><span class="se">\r\n</span>
<span class="gp">SF:\x20\x20\x20\x20&lt;/script&gt;</span><span class="se">\r\n</span>&lt;/head&gt;<span class="se">\r\n</span>&lt;body&gt;<span class="se">\r\n</span>&lt;/body&gt;<span class="se">\r\n</span>&lt;/html&gt;<span class="se">\r\</span>
SF:n<span class="s2">")%r(RTSPRequest,1B4,"</span>HTTP/1<span class="se">\.</span>1<span class="se">\x</span>20200<span class="se">\x</span>20OK<span class="se">\r\n</span>Content-type:<span class="se">\x</span>20text/
<span class="go">SF:html\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x20
SF:\r\n\r\n\xef\xbb\xbf&lt;!DOCTYPE\x20html\x20PUBLIC\x20\"-//W3C//DTD\x20XHT
SF:ML\x201\.0\x20Transitional//EN\"\x20\"http://www\.w3\.org/TR/xhtml1/DTD
</span><span class="gp">SF:/xhtml1-transitional\.dtd\"&gt;</span><span class="se">\r\n\r\n</span>&lt;html<span class="se">\x</span><span class="nv">20xmlns</span><span class="o">=</span><span class="se">\"</span>http://www<span class="se">\.</span>w3<span class="se">\.</span>or
<span class="gp">SF:g/1999/xhtml\"&gt;</span><span class="se">\r\n</span>&lt;<span class="nb">head</span><span class="o">&gt;</span><span class="se">\r\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20&lt;title&gt;&lt;/title&gt;<span class="se">\r\n\x</span>20<span class="se">\x</span>2
<span class="gp">SF:0\x20\x20&lt;script\x20type=\"text/javascript\"&gt;</span><span class="se">\r\n\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>
<span class="gp">SF:20\x20\x20window\.location\.href\x20=\x20\"Pages/login\.htm\";</span><span class="se">\r\n\x</span>20<span class="se">\</span>
SF:x20<span class="se">\x</span>20<span class="se">\x</span>20&lt;/script&gt;<span class="se">\r\n</span>&lt;/head&gt;<span class="se">\r\n</span>&lt;body&gt;<span class="se">\r\n</span>&lt;/body&gt;<span class="se">\r\n</span>&lt;/html&gt;<span class="se">\r\n</span><span class="s2">");
</span><span class="gp">Service Info: OS: Windows;</span><span class="w"> </span><span class="s2">CPE: cpe:/o:microsoft:windows
</span><span class="go">
Host script results:
|_clock-skew: -29s
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 40676/tcp): CLEAN (Couldn't connect)
|   Check 2 (port 20065/tcp): CLEAN (Couldn't connect)
|   Check 3 (port 54993/udp): CLEAN (Failed to receive data)
|   Check 4 (port 62863/udp): CLEAN (Timeout)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-04-14T18:08:40
|_  start_date: N/A

Read data files from: /usr/local/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span><span class="gp">#</span><span class="w"> </span>Nmap <span class="k">done </span>at Wed Apr 15 02:10:08 2020 <span class="nt">--</span> 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>621.83 seconds
</pre></table></code></div></div><p>From nmap, got severals port opened: <strong>21, 22, 80, 135, 139, 445, 5666, 6699, 8443</strong></p><p>Look at the 21 (ftp) port, it allows <strong>anonymous</strong> login. Let’s try it.</p><h3 id="ftp-21">FTP (21)</h3><p>I’ll connect to ftp server as anonymous and password any email format will do.</p><p>Name: <code class="highlighter-rouge">anonymous</code> passwod: <code class="highlighter-rouge">a@a.com</code></p><p><img src="/img/ServMon/2020-04-19-22-48-24.png" alt="" /></p><p>yeah, got in. Let’s see what inside.</p><p><img src="/img/ServMon/2020-04-19-22-51-26.png" alt="" /></p><p>Well, looks like I can list Users dir and got username</p><ol><li>Nadine</li><li>Nathan</li></ol><p>Let’s grab anything I can from both dir.</p><h4 id="nadine-dir">Nadine dir</h4><p>Inside this user, I can see only 1 file named <strong>Confidential.txt</strong>. Grab it!</p><p><img src="/img/ServMon/2020-04-19-22-57-08.png" alt="" /></p><p>Opening Confidential.txt, there was a message in there for Nathan.</p><p><img src="/img/ServMon/2020-04-19-23-00-11.png" alt="" /></p><p>The word <strong>Password</strong> interest me, and it says it’s in Nathan’s desktop. Let’s find it.</p><h4 id="nathan">Nathan</h4><p>Follow similar step for Nadine, just go to Nathan’s dir.</p><p><img src="/img/ServMon/2020-04-19-22-58-53.png" alt="" /></p><p>Only one text file inside it, **Notes to do.txt”. Nevermind, just take it. Open the file.</p><p><img src="/img/ServMon/2020-04-19-23-05-28.png" alt="" /></p><p>It’s literally list to do. Look at point no 3, it says upload the password, but I’m not sure is it done already or not because no remark as complete like above points. And point no 4 telling me nice info.</p><p><code class="highlighter-rouge">Remove public access to NVMS</code> - This highly likely the secret place. Google up NVMS, returned info about some media or CCTV tech. Probably a CMS. Just look for exploit then.</p><h2 id="exploitation">Exploitation</h2><h3 id="searchsploit">SearchSploit</h3><p>I start looking in searchsploit for NVMS</p><p><img src="/img/ServMon/2020-04-19-23-11-28.png" alt="" /></p><p>Oh got 1 exploit for NVMS with name <code class="highlighter-rouge">NVMS 1000</code></p><p><img src="/img/ServMon/2020-04-19-23-13-15.png" alt="" /></p><h3 id="msf">MSF</h3><p>Googling again about the exploit, I got a search result with msf module for this particular exploit. Load my msf right away</p><p><img src="/img/ServMon/2020-04-19-23-26-21.png" alt="" /></p><p>Nice, it vulns for this. Remember about Nathan’s desktop, there should be password file in there. Using this module, let’s jut try it.</p><p><img src="/img/ServMon/2020-04-19-23-35-27.png" alt="" /></p><p>Yeah, the file exits and successfully downloaded it. Read it.</p><p><img src="/img/ServMon/2020-04-19-23-34-49.png" alt="" /></p><p>Whoa, there’s several passwords in there.</p><h3 id="ssh">SSH</h3><p>With that passwords, I will try it in SSH as the port is open. I thought the passwords was for Nathan at firs, try all of it, but failed. I just try with Nadine, got inside with this cred:</p><p>Nadine: <code class="highlighter-rouge">L1k3B1gBut7s@W0rk</code></p><p><img src="/img/ServMon/2020-04-19-23-39-41.png" alt="" /></p><h3 id="user-flag">User Flag</h3><p>Listing file in Desktop dir for nadine, i can see user.txt there</p><p><img src="/img/ServMon/2020-04-19-23-44-23.png" alt="" /></p><p>Let’s grab it.</p><p><img src="/img/ServMon/2020-04-19-23-43-41.png" alt="" /></p><h2 id="privesc">Privesc</h2><h3 id="nsclient">NSCLient++</h3><p>After trying using enum script, which all failed, I go with manual enum. Looking inside Program Files dir, I saw one interesting dir, NSClient++</p><p><img src="/img/ServMon/2020-04-20-00-20-02.png" alt="" /></p><p>Searchsploit about it, returned 1 result.</p><p><img src="/img/ServMon/2020-04-20-00-19-36.png" alt="" /></p><p>Reading about it, got step to exploit it</p><p><img src="/img/ServMon/2020-04-20-00-22-24.png" alt="" /></p><p>Steps:</p><ol><li>Get admin password <code class="highlighter-rouge">open c:\program files\nsclient++\nsclient.ini</code></li><li>Put nc.exe and bat script to execute it</li><li>Add script to cat the bat file</li><li>Schedule it</li></ol><h4 id="admin-password">Admin Password</h4><p>open nsclient.ini</p><p><img src="/img/ServMon/2020-04-20-00-31-07.png" alt="" /></p><p>yeah got password inside it and the host allowed to connect only from localhost.</p><p>Check if curl installed</p><p><img src="/img/ServMon/2020-04-20-00-33-06.png" alt="" /></p><p>This will help me as curl installed in the machine, im lazy to do port forward and reading about NSClient, it have api to do above step. I will take this path!</p><h4 id="upload-ncexe-and-payloadbat">Upload nc.exe and payload.bat</h4><p>Upload nc.exe</p><p><img src="/img/ServMon/2020-04-20-00-44-41.png" alt="" /></p><p>Upload bat file</p><p><img src="/img/ServMon/2020-04-20-00-47-30.png" alt="" /></p><p>Content of my payload for pl.bat script</p><p><img src="/img/ServMon/2020-04-20-00-47-53.png" alt="" /></p><h3 id="api">API</h3><p>Reading about the exploit, it need to write external script. From the documentation in NSClient site, I can achieve same result with api call.</p><p><img src="/img/ServMon/2020-04-20-00-37-34.png" alt="" /></p><p><img src="/img/ServMon/2020-04-20-00-38-03.png" alt="" /></p><p>Let’s try it.</p><h4 id="curl">Curl</h4><p>using this curl command and this password: <strong>ew2x6SsGTxjRwXOT</strong></p><p><code class="highlighter-rouge">curl -s -k -u admin -X PUT https://localhost:8443/api/v1/scripts/ext/scripts/check_new.bat --data-binary @pl.bat</code></p><p><img src="/img/ServMon/2020-04-20-00-52-04.png" alt="" /></p><p>And successfully add the script. And from the API doc, this api call run with runtime permission, so manually add schedule not necessary. Just wait for the script got executed.</p><h3 id="administrator-shell--root-flag">Administrator Shell &amp; Root Flag</h3><p>Run my listener as in the pl.bat script port. It wont take long to get my administrator shell.</p><p><img src="/img/ServMon/2020-04-20-00-54-12.png" alt="" /></p><p>And grab the root flag!!</p><h2 id="reference">Reference</h2><ol><li><a href="https://docs.nsclient.org/api/scripts/#add-script">https://docs.nsclient.org/api/scripts/#add-script</a></li></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/machine/'>machine</a>, <a href='/categories/writeup/'>writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/zeroryuki/ © 2019 zRyuki Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack The Box Write Up - ServMon - zRyuki&url=https://zeroryuki.github.io/posts/servmon/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack The Box Write Up - ServMon - zRyuki&u=https://zeroryuki.github.io/posts/servmon/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hack The Box Write Up - ServMon - zRyuki&url=https://zeroryuki.github.io/posts/servmon/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <!-- The trending tags list v2.0 https://github.com/zeroryuki/ © 2019 zRyuki MIT Licensed --> <a class="post-tag" href="/tags/htb/">htb</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-3">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/zeroryuki/ © 2020 zRyuki MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/mango/" class="btn btn-outline-primary"><p>Hack The Box Write Up - Mango</p></a> <a href="/posts/multimaster/" class="btn btn-outline-primary"><p>Hack The Box Writeup - Multimaster</p></a></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/zeroryuki/ © 2019 zRyuki MIT License --><div id="disqus_thread" class="pt-2 pb-4"><p class="font-italic text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> /* * * CONFIGURATION VARIABLES * * */ var disqus_shortname = "zryuki-space"; var disqus_identifier = "/posts/servmon"; var disqus_url = "https://zeroryuki.github.io/posts/servmon/"; if (document.getElementById('disqus_thread')) { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); } </script> <!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/zeroryuki/ © 2019 zRyuki Published under the MIT License --><div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Registry/"><div class="card-body"> <span class="timeago small"> Apr 5, 2020 <i class="unloaded">2020-04-05T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box Write Up - Registry</h3><div class="text-muted small"><p>Information Gathering Nmap We begin our reconnaissance by running an Nmap scan checking default scripts and testing for vulnerabilities. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 ...</p></div></div></a></div><div class="card"> <a href="/posts/Traverxec/"><div class="card-body"> <span class="timeago small"> Apr 9, 2020 <i class="unloaded">2020-04-09T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box Write Up - Traverxec</h3><div class="text-muted small"><p>Information Gathering As usual, i start my recon with nmap. Nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # Nmap 7.80SVN scan initiated Thu Dec 5 21:18:15 2019 as: nm...</p></div></div></a></div><div class="card"> <a href="/posts/mango/"><div class="card-body"> <span class="timeago small"> Apr 17, 2020 <i class="unloaded">2020-04-17T21:34:29+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box Write Up - Mango</h3><div class="text-muted small"><p>Info Gathering Nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 6...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const el = document.querySelectorAll('#post-wrapper img'); const observer = lozad(el); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">zRyuki</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted">Trending Tags</h4><!-- The trending tags list v2.0 https://github.com/zeroryuki/ © 2019 zRyuki MIT Licensed --> <a class="post-tag" href="/tags/htb/">htb</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/zeroryuki/ © 2017-2019 zRyuki MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://zeroryuki.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script><div class="modal fade" id="howModal" tabindex="-1" role="dialog" aria-hidden="true" style="display: none;"><div class="modal-dialog"><div class="modal-content"><div class="modal-header text-center"><div class="row"><div class="col-lg-12"> <img src="/img/ServMon/icon.png" style="height: 40px"><h4 data-toc-skip class="modal-title">SERVMON</h4><small>This is an active Windows machine. You will need Administrator hash to read the content</small><br></div></div></div><div class="modal-body"><div class="row"><div class="col-lg-12"><h4 data-toc-skip>How to unlock</h4><span class="subscriptionInfo"><p><i class="fas fa-hashtag"></i> Get machine's Administrator NTLM hash<br> <code class="highlighter-rouge"><small>meterpreter > hashdump</small></code></p><p><i class="fas fa-hashtag"></i> Hash<br> <code class="highlighter-rouge"><small>echo "{ value }" | md5sum</small></code></p><p><i class="fas fa-sign-in-alt"></i> Add hash below</p></span><div class="row"><div class="col-lg-8"> <input type="text" placeholder="Insert hash here.." value="" name="key" id="key" class="form-control"></div><div class="col-lg-4"> <span role="button" tabindex="0"> <button id="decrypt" tabindex="-1" type="submit" class="decrypt-btn" style="background-color: rgb(154, 204, 20); border-color: rgb(154, 204, 20); color: white;"> Decrypt </button> </span></div></div></div><div class="col-lg-12 text-center m-t-md" id="recurlyBalanceControlPanel"> You have <span class="text-warning">-</span> remaining attempt</div></div></div><div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal"><i class="far fa-times"></i></button></div></div></div></div>
